{{ 'cart-fulfillment.css' | asset_url | stylesheet_tag }}

<div class="cart-fulfillment-selector" data-cart-fulfillment>
  <h3 class="cart-fulfillment__title">
    How would you like to receive your order?
  </h3>
  
  <div class="cart-fulfillment__options">
    <div class="cart-fulfillment__option">
      <input 
        type="radio" 
        id="fulfillment-delivery" 
        name="fulfillment-type" 
        value="delivery"
        class="cart-fulfillment__radio"
        {% if cart.attributes.fulfillment_type == 'delivery' or cart.attributes.fulfillment_type == blank %}checked{% endif %}
      >
      <label for="fulfillment-delivery" class="cart-fulfillment__label">
        <span class="cart-fulfillment__icon">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M18 8V6C18 4.9 17.1 4 16 4H4C2.9 4 2 4.9 2 6V8M18 8H2M18 8V14C18 15.1 17.1 16 16 16H4C2.9 16 2 15.1 2 14V8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M6 8V12M10 8V12M14 8V12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
          </svg>
        </span>
        <div class="cart-fulfillment__text">
          <span class="cart-fulfillment__option-title">
            Ship to me
          </span>
          <span class="cart-fulfillment__option-desc">
            Standard shipping to your address
          </span>
        </div>
      </label>
    </div>

    <div class="cart-fulfillment__option">
      <input 
        type="radio" 
        id="fulfillment-pickup" 
        name="fulfillment-type" 
        value="pickup"
        class="cart-fulfillment__radio"
        {% if cart.attributes.fulfillment_type == 'pickup' %}checked{% endif %}
      >
      <label for="fulfillment-pickup" class="cart-fulfillment__label">
        <span class="cart-fulfillment__icon">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M3 7V5C3 3.9 3.9 3 5 3H15C16.1 3 17 3.9 17 5V7M3 7H17M3 7V15C3 16.1 3.9 17 5 17H15C16.1 17 17 16.1 17 15V7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            <circle cx="10" cy="12" r="2" stroke="currentColor" stroke-width="1.5"/>
          </svg>
        </span>
        <div class="cart-fulfillment__text">
          <span class="cart-fulfillment__option-title">
            Pick up in store
          </span>
          <span class="cart-fulfillment__option-desc">
            Available at select locations
          </span>
        </div>
      </label>
    </div>
  </div>

  <div class="cart-fulfillment__pickup-locations" 
       {% if cart.attributes.fulfillment_type != 'pickup' %}style="display: none;"{% endif %}>
    <label for="pickup-location" class="cart-fulfillment__location-label">
      Select store location:
    </label>
    <select 
      id="pickup-location" 
      class="cart-fulfillment__location-select"
      data-pickup-location-select
    >
      <option value="">Choose a location...</option>
      {% comment %} You can add static locations here or populate via JavaScript {% endcomment %}
      {% for location in shop.locations %}
        {% if location.active %}
          <option value="{{ location.id }}" 
                  data-location-name="{{ location.name }}"
                  {% if cart.attributes.pickup_location_id == location.id %}selected{% endif %}>
            {{ location.name }}{% if location.address %} - {{ location.address | strip_html }}{% endif %}
          </option>
        {% endif %}
      {% endfor %}
    </select>
  </div>

  <div class="cart-fulfillment__loading" style="display: none;">
    <div class="cart-fulfillment__loading-spinner"></div>
    <span>Updating...</span>
  </div>

  <div class="cart-fulfillment__error" style="display: none;"></div>
</div>

{% comment %} Configure the Shopify app URL for API calls {% endcomment %}
<script>
  // Set the app URL globally - updated to production URL
  window.SHOPIFY_APP_URL = 'https://syatt-fulfillment-d4pju.ondigitalocean.app';
  
  // You can also set cart data for JavaScript access
  window.cartAttributes = {{ cart.attributes | json }};
</script>

<script src="{{ 'cart-fulfillment.js' | asset_url }}" defer></script>